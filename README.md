# Strategic Insights from TMDB500 Movie Dataset Analysis

## Objective
Develop a comprehensive analysis framework using SQL to enhance decision-making in the film industry by uncovering insights into user engagement, budget optimization, genre-based recommendations, and optimal movie release dates based on the TMDB 5000 Movie Dataset with Ratings.

### Business Tasks:
* Explore whether specific genres lead to higher user engagement.
* Develop insights into the optimal budget range for different genres.
* Develop a model that suggests movies to users based on their historical ratings and preferences for specific genres.
* Analyze the relationship between movie release dates and revenue.

## Data Source:
The TMDB 5000 Movie Dataset with Ratings is a comprehensive compilation that combines the original TMDb 5000 Movie Dataset with additional user ratings, providing an in-depth exploration of the cinematic realm.

The dataset was obtained through [Kaggle](https://www.kaggle.com/datasets/aayushsoni4/tmdb-5000-movie-dataset-with-ratings?select=tmdb_movie_dataset.csv) a platform for data related competitions, datasets, and collaboration among data enthusiast.

    tmdb_movie_dataset:
        Columns:
            **budget:** The budget allocated for the movie.
            **genres:** Genres associated with the movie.
            **homepage:** The homepage URL of the movie.
            **tmdbId:** The unique identifier assigned by TMDb.
            **keywords:** Keywords or tags related to the movie.
            **original_language:** The original language of the movie.
            **original_title:** The original title of the movie.
            **overview:** A brief overview or synopsis of the movie.
            **popularity:** Popularity score of the movie.
            **production_companies:** Companies involved in the movie's production.
            **production_countries:** Countries where the movie was produced.
            **release_date:** The date when the movie was released.
            **revenue:** The revenue generated by the movie.
            **runtime:** The duration of the movie in minutes.
            **spoken_languages:** Languages spoken in the movie.
            **status:** The production status of the movie.
            **tagline:** A tagline associated with the movie.
            **title:** The title of the movie.
            **vote_average:** Average user rating.
            **vote_count:** The number of votes the movie received.
            **ratingId:** Unique identifier for ratings.

    tmdb_movie_credits:
        Columns:
            **tmdbId:** The unique identifier assigned by TMDb.
            **title:** The title of the movie.
            **cast:** Cast members of the movie.
            **crew:** Crew members involved in the movie.

    tmdb_movie_ratings:
        Columns:
            **userId:** Unique identifier for users.
            **ratingId:** Unique identifier for ratings.
            **rating:** User rating for the movie.
            **timestamp:** The timestamp when the rating was given.


## Process 

1. Automated uploading of dataset to posgresql through a python script

```python
# Library
import psycopg2
import pandas as pd
from sqlalchemy import create_engine, text

# Define the database connection parameters
db_params = {
    'host': 'xxxxxxxxx',
    'database': 'xxxxxxxxx',
    'user': 'xxxxxxxxx',
    'password': 'xxxxxxxxxx'
}

# Connect to the 'xxxxxxxx' database
db_params['database'] = 'xxxxxxxx'
engine = create_engine(f'postgresql://{db_params["user"]}:{db_params["password"]}@{db_params["host"]}/{db_params["database"]}')

# Define the file paths for your CSV files
csv_files = {
    'tmdb_movie_credits': '/home/tmdb_movie_credits.csv',
    'tmdb_movie_dataset': '/home/tmdb_movie_dataset.csv',
    'tmdb_movie_ratings': '/home/tmdb_movie_ratings.csv',
}

# Load and display the contents of each CSV file to check
for table_name, file_path in csv_files.items():
    print(f"Contents of '{table_name}' CSV file:")
    df = pd.read_csv(file_path)
    print(df.head(2))  # Display the first few rows of the DataFrame
    print("\n")

# Loop through the CSV files and import them into PostgreSQL
for table_name, file_path in csv_files.items():
    df = pd.read_csv(file_path)
    df.to_sql(table_name, engine, if_exists='replace', index=False)
```

2. Created a summarized table for further analysis

```sql
SELECT 
    tmdbid,
    title,
    AVG(rating) AS avg_rating,
    popularity,
    original_language,
    revenue,
    budget,
    revenue - budget AS profit,
    release_date,
    runtime
FROM tmdb_movie_dataset AS dataset 
FULL OUTER JOIN tmdb_movie_ratings AS rate
    ON dataset.ratingid = rate.ratingid
GROUP BY
    tmdbid,
    title,
    popularity,
    original_language,
    revenue,
    budget,
    release_date,
    runtime
ORDER BY popularity DESC, 1
```

## Analysis

1. Conducted exploratory data analysis

```sql
SELECT tmdbid, title, AVG(rating) AS avg_rating
FROM tmdb_movie_dataset AS dataset 
JOIN tmdb_movie_ratings AS rate
    ON dataset.ratingid = rate.ratingid
GROUP BY tmdbid, title
ORDER BY avg_rating DESC, 1
```

Top 10 highly rated-rated movies
```
 tmdbid |                    title                    |    avg_rating     
--------+---------------------------------------------+-------------------
  56491 | In Her Line of Fire                         |                 5
  67373 | This Thing of Ours                          |                 5
  73511 | The Californians                            |                 5
 112937 | The Oogieloves in the Big Balloon Adventure |                 5
 170480 | The Deported                                |                 5
 248402 | A Fine Step                                 |                 5
 362765 | The Sound and the Shadow                    |              4.75
  89540 | The Other Conquest                          |               4.5
    278 | The Shawshank Redemption                    | 4.413576004516335
    238 | The Godfather                               | 4.324336165187245
(10 rows)
```
